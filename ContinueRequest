<script runat="server">
    Platform.Load("core", "1");
    try {
        var api = new Script.Util.WSProxy();
        api.setClientId({
            "ID": Platform.Function.AuthenticatedMemberID(),
            "UserID": Platform.Function.AuthenticatedEmployeeID()
        });

        var soapObjectname = "DataExtension";
        var response = api.describe(soapObjectname);
        var properties = response.Results[0].Properties; 
        var propertiesName = [];

        for (var i in properties) {
            var name = properties[i].Name;
            var isRetrievable = properties[i].IsRetrievable;
            if (isRetrievable === true) {
                propertiesName.push(name);
            }
        }

        var filter = {
                        Property: "IsSendable",        
                        SimpleOperator: "equals", 
                        Value: "true"           
                    };
        
        var batch ={BatchSize : 300};
        var props: { QueryAllAccounts: false};
        var response = RetrieveSoapObject(soapObjectname, propertiesName,filter,batch,props,api);
        Write(Stringify(response));
    } catch (ex) {
        // If an exception occurs during the execution, catch it and write the error messages to the output.
        Write(ex.message);
        Write(ex.description);
        Write(ex.jintException);
    }

function RetrieveSoapObject(soapObjectname, propertiesName,filter,batch,props,api) {
 
  var records=[];
  var hasMoreData=true;
  var requestId=null;
  var data= null;

  While(hasMoreData){
        hasMoreData=false;
        if(requestId){
            props.ContinueRequest=requestId;
             // Call the retrieve method of WSProxy to fetch data from the SOAP object.
            var response = api.retrieve(soapObjectname, propertiesName,filter,batch,props);
        }
           
        if(response){
            hasMoreData=response.HasMoreRows;
            requestId=response.RequestID;
            var results=response.Results;
            records.push(results);
        }
    }

  // Return the response, which contains the retrieved data from the SOAP object.
  return records;
}

</script>
